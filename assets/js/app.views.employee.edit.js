app={views:{employee:{}}},app.views.employee.edit=function(e){if(!e)throw"Element undefined";this.$el=e,this.db=new Store("employees"),this.init()},app.views.employee.edit.prototype={init:function(){this.$elSave=this.$el.parentElement.querySelector("[name='save']"),this.$elDelete=this.$el.parentElement.querySelector("[name='delete']"),this.$elCancel=this.$el.parentElement.querySelector("[name='cancel']"),this.$elId=this.$el.parentElement.querySelector("[name='id']"),this.$elName=this.$el.parentElement.querySelector("[name='name']"),this.$elDepartament=this.$el.parentElement.querySelector("[name='departament']"),this.setDepartaments(),location.search&&this.dataFill(),this.initEvents()},setDepartaments:function(){var e=new Store("departaments").get().reduce(function(e,t){return e=e.concat("<option value='").concat(t.id).concat("'>").concat(t.description).concat("</option>")},"");this.$elDepartament.innerHTML="<option value='0'></option>".concat(e)},dataFill:function(){var e=window.location.search.replace("?","").split("&").reduce(function(e,t){var n=t.split("=");return e[n[0]]=n[1],e},{});this.$elId.value=e.id;var t=0===Number(e.id);if(!t){var n=this.db.getItemById(e.id);this.$elName.value=n.name;var a=this.$elDepartament.parentElement.querySelector("option[value='"+n.departament.id+"']");a&&(a.selected=!0)}this.$elId.disabled=!0,this.$elId.readOnly=!0,this.$elName.focus(),this.$elDelete.hidden=t},valid:function(e){if(!e.name){var t="Name is required";throw alert(t),t}if(!e.departament){t="Departament is required";throw alert(t),t}},save:function(){var e={id:Number(this.$elId.value),name:this.$elName.value,departament:{}},t=this.$elDepartament.selectedOptions[0].value,n=new Store("departaments").getItemById(t);e.departament=n,this.valid(e),this.db.save(e,function(t){t.name=e.name,t.departament=e.departament})},delete:function(){this.db.removeItem(Number(this.$elId.value))},goIndex:function(){window.location="index.html"},initEvents:function(){var e=this;this.$elSave.addEventListener("click",function(){e.save(),e.goIndex()}),this.$elDelete.addEventListener("click",function(){e.delete(),e.goIndex()}),this.$elCancel.addEventListener("click",function(){e.goIndex()})}};